import{a as R}from"./chunk-QWW5S7JA.js";import{a as z,b as c,c as A,d as q,f as G,g as B,h as Q,i as $,k as U}from"./chunk-ATABQZHM.js";import{a as W}from"./chunk-WVEHC2QO.js";import"./chunk-DQLBTGLA.js";import{a as j}from"./chunk-PT6TDUZY.js";import{Aa as o,Ba as i,Ca as l,Fa as M,Gb as I,H as h,Ha as g,Ia as S,J as P,Jb as L,Oa as _,P as d,Pa as x,Q as p,Qa as C,Sa as n,Ta as E,Ua as F,Wa as T,ba as m,lb as D,m as O,mb as V,qa as v,sa as f,ta as w,ub as N,z as k}from"./chunk-HVBQXB2O.js";import"./chunk-P2VZOJAX.js";var H=["popbtn"],K=["customerModal"],Y=["already"];function Z(b,u){if(b&1){let y=M();o(0,"tr",57),g("click",function(){let a=d(y).$implicit,e=S();return p(e.storeCustomerCode(a.customercode,a.customername))}),o(1,"td",58),n(2),i()()}if(b&2){let y=u.$implicit;m(2),E(y.customername||"Unnamed Customer")}}function X(b,u){b&1&&(o(0,"div",59),l(1,"div",60),i())}var pe=(()=>{let u=class u{constructor(){this.fb=h($),this.service=h(j),this.logic=h(W),this.router=h(I),this.customerDetails=[],this.loader=!1,this.duplicateCustomerDetails=[],this.cusForm=this.fb.group({customer_Gst_no:[""],firstname:["",c.required],lastName:[""],customer_Mobile:["",[c.required,c.minLength(10),c.maxLength(10)]],customer_Mobile2:[""],customer_Email:["",[c.required,c.email]],gender:["MALE"],dateOfBirth:[""],customer_pin:["600119"],customercode:[""],customername:[""],customerstatus:[""],distributor_Code:["91037014"],customer_Distributor:[""],id_proff:[""],customer_State:["Tamilnadu"],customer_city:["chennai"],attach1:[""],attach2:[""],attach3:[""],cremarks1:[""],cremarks2:[""],cremarks3:[""],cremarks4:[""],cremarks5:[""],lcreateddate:[""]}),this.customerRequest=this.fb.group({filtervalue1:"0091037014",filtervalue2:"IT-ADMIN",filtervalue3:"Customer1",filtervalue4:"bill_to",filtervalue5:"",filtervalue6:"",filtervalue7:"",filtervalue8:""}),this.otpForm=this.fb.group({filtervalue1:["",c.required],filtervalue2:["",[c.required,c.minLength(4),c.maxLength(4)]]}),this.countdownTime=60,this.offer={name:"walmast",type:"asian_paints",offerPrice:510,price:700,perctange:20},this.combo={products:[{name:"walmast",type:"asian_paints",price:700},{name:"walmast",type:"asian_paints",price:700}],combo:{offerPrice:510,price:700,perctange:20}}}formSubmit(){if(this.loader=!0,this.number=this.cusForm.get("customer_Mobile")?.value,this.cusForm.valid){let t=this.cusForm.get("firstname")?.value,a=this.cusForm.get("customer_Mobile")?.value,e=this.cusForm.get("customer_Email")?.value;localStorage.setItem("apName",t||"not found"),localStorage.setItem("apNumber",a||"no number"),localStorage.setItem("apEmail",e||"no email");let r=this.cusForm.value;this.service.createCustomer(r).subscribe(s=>{if(Array.isArray(s)&&localStorage.setItem("apCusId",s[0][0].CUSTOMER.CUSTOMER),s?.includes("Mobile Number Already Registered for this CustomerCode")){this.already.nativeElement.click(),this.loader=!1;return}Object.keys(s).length>0?(this.cusForm.get("customer_Mobile")?.value&&this.otpForm.patchValue({filtervalue1:this.number}),this.loader=!1,this.popbtn.nativeElement.click(),this.startCountdown()):this.router.navigateByUrl("/home#image")})}}resendOtp(){this.service.reSendOtp(this.otpForm.value).subscribe(t=>{this.startCountdown()})}verfiyOtp(){this.number=this.cusForm.get("customer_Mobile")?.value,this.cusForm.get("customer_Mobile")?.value&&this.otpForm.patchValue({filtervalue1:this.number}),this.loader=!0,this.otpForm.valid&&this.service.verfiyOtp(this.otpForm.value).subscribe(t=>{t=="OTP Verified"?(this.loader=!1,this.popbtn.nativeElement.click(),this.logic.cus("success","","OTP verfied!"),window.history.back()):this.logic.cus("error","","Invalid OTP!")})}getCustomerDetails(){this.service.getCustomerDetails(this.customerRequest.value).subscribe(t=>{if(typeof t=="string")try{this.customerDetails=JSON.parse(t),this.duplicateCustomerDetails=JSON.parse(t)}catch(a){console.error("Failed to parse response:",a),this.customerDetails=[]}else Array.isArray(t)?(this.customerDetails=t,this.duplicateCustomerDetails=t):(this.customerDetails=[],this.duplicateCustomerDetails=[]);this.customerModal.nativeElement.click()},t=>{console.log("Error in this API",t)})}storeCustomerCode(t,a){localStorage.setItem("apCusId",t),localStorage.setItem("apName",a);let e="session-"+Math.random().toString(36).substr(2,9);this.service.setSessionId(e),window.history.back()}closeCustomerModal(){this.customerModal.nativeElement.close()}formReset(){this.popbtn.nativeElement.click(),this.logic.cus("success","","Form reset!"),this.cusForm.reset()}startCountdown(){O(1e3).pipe(k(()=>this.countdownTime>0)).subscribe(()=>{this.countdownTime--})}formatTime(t){let a=Math.floor(t/60),e=t%60;return`${this.pad(a)}:${this.pad(e)}`}pad(t){return t<10?"0"+t:t.toString()}FilterByName(t){if(t.target.value){let a=this.duplicateCustomerDetails.filter(e=>Object.keys(e).some(r=>e[r].toString().toLowerCase().includes(t.target.value.toString().toLowerCase())));this.customerDetails=a}else this.customerDetails=this.duplicateCustomerDetails}};u.\u0275fac=function(a){return new(a||u)},u.\u0275cmp=P({type:u,selectors:[["app-customer-login"]],viewQuery:function(a,e){if(a&1&&(_(H,5),_(K,5),_(Y,5)),a&2){let r;x(r=C())&&(e.popbtn=r.first),x(r=C())&&(e.customerModal=r.first),x(r=C())&&(e.already=r.first)}},standalone:!0,features:[T],decls:86,vars:11,consts:[["popbtn",""],["customerModal",""],["already",""],[1,"relative"],[1,"home-box"],[1,"h-[620px]","w-[1100px]","bg-front","flex"],[1,"w-1/2"],["src","../../../assets/images/allpaintsLogo_tagline 2.png","alt","","srcset","",1,"logo-img"],[1,"w-1/2","h-full","content-box"],[1,"wel-box"],["src","../../../assets/images/title.png","alt","","srcset",""],[1,"bg-red-500","text-white","p-2","mb-5","rounded-md","shadow-md","block","mx-auto","w-fit"],[3,"click"],[1,"h-[350px]","flex","flex-col","w-3/4","mx-auto",3,"formGroup"],["for","Sp"],["formControlName","firstname","type","text"],["for","num"],["id","num","formControlName","customer_Mobile","onkeypress","return event.keyCode === 8 || event.charCode >= 48 && event.charCode <= 57","type","text"],[1,"checkboxes"],["type","checkbox","name","","id","phn"],["for","phn"],["type","checkbox","name","","id","wp"],["for","wp"],["for","em"],["formControlName","customer_Email","id","em","type","email"],[1,"buttons"],[3,"click","disabled"],["onclick","my_modal_2.showModal()",1,"btn",2,"display","none"],["onclick","customerModal.showModal()",1,"btn",2,"display","none"],["id","my_modal_2",1,"modal"],[1,"modal-box","bg-white","pop-box",3,"formGroup"],[1,"text-lg","font-bold"],[1,"py-4"],["formControlName","filtervalue2","type","text"],[1,"w-[300px]","flex","justify-end"],[1,"bg-(var(--prim))"],[1,"underline","text-[var(--prim)]","cursor-pointer",3,"click"],[1,"bttn",3,"click","disabled"],["method","dialog",1,"modal-backdrop"],["id","customerModal",1,"modal"],["onclick","document.getElementById('customerModal').close()",1,"text-2xl","bg-white","absolute","right-0","-top-10","h-7","w-7"],[1,"customer-list-container"],[1,"table-container"],[1,"w-full","bg-white","border","border-gray-300","rounded-lg","shadow-md"],[1,"bg-gray-200"],[1,"flex","justify-between","w-full","px-5","items-center"],[1,"p-3","text-left","text-gray-700","font-semibold"],["placeholder","Search by Name or Code",1,"p-1","rounded-md",3,"input"],["class","cursor-pointer hover:bg-gray-100 border-b border-gray-200",3,"click",4,"ngFor","ngForOf"],["onclick","already.showModal()",1,"btn",2,"display","none"],["id","already",1,"bg-white","p-5","fixed","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2"],[1,"relative","w-full","h-full","p-5"],[1,"bg-white","text-xl","font-semibold","flex","gap-2"],["src","../../../assets/images/exclamation-punctuation.gif",1,"w-4","h-5","object-contain"],["onclick","document.getElementById('already').close()",1,"absolute","-top-5","-right-2","text-2xl"],[1,"bg-red-500","text-white","p-2","mt-5","rounded-md","shadow-md","block","mx-auto","w-fit"],["class","w-full bg-black bg-opacity-10 h-screen fixed top-0 left-0 flex justify-center z-50 items-center",4,"ngIf"],[1,"cursor-pointer","hover:bg-gray-100","border-b","border-gray-200",3,"click"],[1,"p-4","text-gray-800"],[1,"w-full","bg-black","bg-opacity-10","h-screen","fixed","top-0","left-0","flex","justify-center","z-50","items-center"],[1,"loader"]],template:function(a,e){if(a&1){let r=M();l(0,"app-header"),o(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6),l(5,"img",7),i(),o(6,"div",8)(7,"div",9),l(8,"img",10),i(),o(9,"div",11)(10,"button",12),g("click",function(){return d(r),p(e.getCustomerDetails())}),n(11,"Get Customer Details"),i()(),o(12,"div",13)(13,"label",14),n(14,"Customer Name:"),i(),l(15,"input",15),o(16,"label",16),n(17,"Number:"),i(),l(18,"input",17),o(19,"div",18),l(20,"input",19),o(21,"label",20),n(22,"Phone"),i(),l(23,"input",21),o(24,"label",22),n(25,"Whatsapp"),i()(),o(26,"label",23),n(27,"Email:"),i(),l(28,"input",24),o(29,"div",25)(30,"button",12),g("click",function(){return d(r),p(e.formReset())}),n(31,"Reset"),i(),o(32,"button",26),g("click",function(){return d(r),p(e.formSubmit())}),n(33,"Proceed"),i()()()()()()(),o(34,"button",27,0),n(36,"open modal"),i(),o(37,"button",28,1),n(39,"open modal"),i(),o(40,"dialog",29)(41,"div",30)(42,"h3",31),n(43,"Verify with OTP"),i(),o(44,"p",32),n(45,"To ensure your security, Please enter the One-Time Password (OTP) sent to your registered mobile number/email below"),i(),l(46,"input",33),o(47,"div",34)(48,"p",35),n(49),i(),o(50,"p",36),g("click",function(){return d(r),p(e.resendOtp())}),n(51,"Resend Otp"),i()(),o(52,"button",37),g("click",function(){return d(r),p(e.verfiyOtp())}),n(53,"Submit"),i()(),l(54,"form",38),i(),o(55,"dialog",39,1)(57,"div",3)(58,"button",40),n(59,"\u2715"),i(),o(60,"div",41)(61,"div",42)(62,"table",43)(63,"thead")(64,"tr",44)(65,"div",45)(66,"p",46),n(67,"Customer Name"),i(),o(68,"input",47),g("input",function(J){return d(r),p(e.FilterByName(J))}),i()()()(),o(69,"tbody"),v(70,Z,3,1,"tr",48),i()()()()()(),o(71,"button",49,2),n(73,"open modal"),i(),o(74,"dialog",50,2)(76,"div",51)(77,"div",52),n(78," Mobile Number Already Registered "),l(79,"img",53),i(),o(80,"button",54),n(81,"x"),i(),o(82,"div",55)(83,"button",12),g("click",function(){return d(r),p(e.getCustomerDetails())}),n(84,"Get Customer Details"),i()()()(),v(85,X,2,0,"div",56)}if(a&2){let r;m(12),f("formGroup",e.cusForm),m(20),f("disabled",e.cusForm.invalid),m(9),f("formGroup",e.otpForm),m(7),w("display",e.countdownTime>0?"block":"none"),m(),F("",e.formatTime(e.countdownTime)," "),m(),w("display",e.countdownTime>0?"none":"block"),m(2),f("disabled",(r=e.otpForm.get("filtervalue2"))==null?null:r.invalid),m(18),f("ngForOf",e.customerDetails),m(15),f("ngIf",e.loader)}},dependencies:[R,U,G,z,A,q,B,Q,L,N,D,V],styles:['.home-box[_ngcontent-%COMP%]{height:calc(100vh - 100px);width:100%;background-image:url("./media/home-bg-ZVF7KICD.png");background-size:contain;background-repeat:no-repeat;display:flex;align-items:center;justify-content:center}.bg-front[_ngcontent-%COMP%]{background-image:url("./media/bg-IBFI4WTO.png");background-size:contain}.logo-img[_ngcontent-%COMP%]{margin:45px auto 0}.content-box[_ngcontent-%COMP%]{background-color:#ffffffd6;margin:0 auto}.content-box[_ngcontent-%COMP%]   .wel-box[_ngcontent-%COMP%]{height:150px;display:flex;align-items:center;justify-content:center}.content-box[_ngcontent-%COMP%]   .wel-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60%;mix-blend-mode:multiply}.content-box[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-top:80px;margin-bottom:40px;height:40%;font-size:40px}.content-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;font-size:20px}.content-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:.5px solid rgba(0,0,0,.3803921569);border-radius:6px;background-color:transparent;height:35px;padding-left:10px}.content-box[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{margin-top:50px;display:flex}.content-box[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{box-sizing:content-box;background-color:var(--prim);padding:5px 45px;width:fit-content;margin:0 auto;font-size:19px;color:#fff;border-radius:10px;transition:.25s ease-in}.content-box[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:gray;cursor:not-allowed}.content-box[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{transform:translateY(5px) scale(.96)}.content-box[_ngcontent-%COMP%]   .checkboxes[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px}.content-box[_ngcontent-%COMP%]   .checkboxes[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px}.content-box[_ngcontent-%COMP%]   .checkboxes[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{accent-color:var(--prim)}.pop-box[_ngcontent-%COMP%]{height:450px;width:600px;min-width:620px;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px}.pop-box[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:28px}.pop-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:40px;width:300px;border:1px solid rgba(0,0,0,.5215686275);display:flex;justify-content:space-evenly;border-radius:10px}table[_ngcontent-%COMP%]{width:100%;background-color:#fff;border:1px solid #d1d5db;border-radius:.375rem;box-shadow:0 4px 8px #0000001a}.customer-list-container[_ngcontent-%COMP%]{width:450px;margin:0 auto}.table-container[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;border-radius:.375rem;border:1px solid #d1d5db}h4[_ngcontent-%COMP%]{font-weight:700;font-size:1.25rem;margin-bottom:1rem;text-align:center}table[_ngcontent-%COMP%]{width:100%;background-color:#fff;border-radius:.375rem;box-shadow:0 4px 8px #0000001a}th[_ngcontent-%COMP%]{padding:.75rem;text-align:left;font-weight:600;color:#4b5563}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer;border-bottom:1px solid #e5e7eb}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}td[_ngcontent-%COMP%]{padding:1rem;color:#374151}.loader[_ngcontent-%COMP%]{width:70px;height:70px;display:inline-block;border:5px solid rgb(255,17,0);border-radius:50%;border-top-color:transparent;border-bottom-color:transparent;animation:_ngcontent-%COMP%_rot5 1s infinite}@keyframes _ngcontent-%COMP%_rot5{0%{transform:rotate(0)}50%{transform:rotate(180deg);border-top-color:#8b2e2e;border-bottom-color:#f35c21;border-right-color:transparent;border-left-color:transparent}to{transform:rotate(360deg)}}']});let b=u;return b})();export{pe as CustomerLoginComponent};
